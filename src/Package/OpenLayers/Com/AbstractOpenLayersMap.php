<?phpnamespace Nemundo\Package\OpenLayers\Com;use Nemundo\Com\Style\DimensionStyle;use Nemundo\Com\Style\DimensionUnit;use Nemundo\Core\Type\Geo\GeoCoordinate;use Nemundo\Html\Block\Div;use Nemundo\Html\Script\JavaScript;abstract class AbstractOpenLayersMap extends Div{    /**     * @var int     */    public $zoom;    /**     * @var DimensionStyle     */    public $dimension;    /**     * @var GeoCoordinate     */    public $mapCenter;    // setCenter()    protected $defaultLayer;    private $layer = [];    private $kmlLayer = [];    //private static $mapCount = 0;    public function loadContainer()    {        parent::loadContainer();        $this->mapCenter = new GeoCoordinate();        $this->mapCenter->latitude = 0;        $this->mapCenter->longitude = 0;        $this->zoom = 10;        $this->dimension = new DimensionStyle();        $this->dimension->widthUnit = DimensionUnit::PERCENT;        $this->dimension->width = 100;        $this->dimension->height = 500;    }    public function addLayer($layer)    {        $this->layer[] = $layer;        return $this;    }    public function addKmlLayer($url)    {        $this->kmlLayer[] = $url;        return $this;    }    public function getContent()    {        new OpenLayersHeaderPackage($this);        $this->id = 'map';        $this->addAttribute('style', $this->dimension->getStyle());        $script = new JavaScript($this);        $script->addContent('        window.onload = function () {        let map = new ol.Map({        target: "map",        layers: [' . $this->defaultLayer . '        ],        view: new ol.View({          center: ol.proj.fromLonLat([' . $this->mapCenter->longitude . ',' . $this->mapCenter->latitude . ']),          zoom: ' . $this->zoom . '        })      });');        foreach ($this->kmlLayer as $kmlLayer) {            $script->addCodeLine('var vector = new ol.layer.Vector({');            $script->addCodeLine('source: new ol.source.Vector({');            $script->addCodeLine('url: "' . $kmlLayer . '",');            $script->addCodeLine('format : new ol.format.KML({');            $script->addCodeLine('projection: "EPSG:21781"');            $script->addCodeLine('})');            $script->addCodeLine('})');            $script->addCodeLine('});');            $script->addCodeLine('map.addLayer(vector);');        }        $script->addCodeLine(' };');        return parent::getContent();    }}